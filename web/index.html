<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Power Bank Rental</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="/">
    <script src="https://js.braintreegateway.com/web/3.91.0/js/client.min.js"></script>
    <script src="https://js.braintreegateway.com/web/3.91.0/js/apple-pay.min.js"></script>
    <script>
        function startApplePay(clientToken, callbackName) {
          braintree.client.create({ authorization: clientToken }, function (err, clientInstance) {
            if (err) return console.error(err);

            braintree.applePay.create({ client: clientInstance }, function (err, applePayInstance) {
              if (err) return console.error(err);

              const paymentRequest = applePayInstance.createPaymentRequest({
                total: { label: 'Recharge', amount: '4.99' },
                requiredBillingContactFields: ['postalAddress']
              });

              const session = new ApplePaySession(3, paymentRequest);

              session.onvalidatemerchant = function (event) {
                applePayInstance.performValidation({ validationURL: event.validationURL })
                  .then(data => session.completeMerchantValidation(data));
              };

              session.onpaymentauthorized = function (event) {
                applePayInstance.tokenize({ token: event.payment.token })
                  .then(payload => {
                    window.handleApplePayResult(payload.nonce);
                    session.completePayment(ApplePaySession.STATUS_SUCCESS);
                  });
              };

              session.begin();
            });
          });
        }
    </script>
</head>
<body>
<script src="flutter_bootstrap.js" async></script>
</body>
</html>
